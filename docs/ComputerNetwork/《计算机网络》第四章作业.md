# 《计算机网络》第四章作业

## 4-01

**答：**一种是面向连接的服务（虚电路服务），一种是无连接的服务（数据报服务）。

面向连接的服务（可靠通信由网络保证）：

- 优点：分组开销小；分组无差错。
- 缺点：网络成本高；若某一节点出错，所有通过该节点的虚电路都不能正常工作。

无连接的服务（可靠通信由用户主机保证）：

- 优点：网络成本低；某一节点出错时，路由可能变化，数据报可能仍然可以传输。
- 缺点：尽力交付，可能会出现数据报异常情况。

## 4-03

**答：**他们都起到连接网络的作用，但处在不同的网络体系结构层级。转发器在物理层，网桥在数据链路层，路由器在网络层，而网关在运输层及应用层（路由器也可以表示网关）。

## 4-07

**答：**IP地址是网络层及以上使用的逻辑地址，而硬件地址是物理层及数据链路层使用的地址。由于不同国家、区域等有着不同的网络结构，其中的主机都有不同形式的硬件地址，因此若需要跨域传输时，会存在复杂的硬件地址转换。使用统一的IP地址可以使用户间的通信好像在一个网络上一样。IP地址与硬件地址的转换也相对硬件地址与硬件地址的转换要方便许多。

## 4-10

**答：**（1）**10**000000.00100100.11000111.00000011，为B类地址；

（2）**0**0010101.00001100.11110000.00010001，为A类地址；

（3）**10**110111.11000010.01001100.11111101，为B类地址；

（4）**110**00000.00001100.01000101.11111000，为C类地址；

（5）**0**1011001.00000011.00000000.00000001，为A类地址；

（6）**110**01000.00000011.00000110.00000010，为C类地址。

## 4-11

**答：**好处是减小开销（加快检验、转发分组更快）；坏处是在网络层传输的过程中就算数据发生了错误，也无法识别并中止传输，需要到达终点后在主机上（运输层）才能进行校验。

## 4-15

**答：**MTU是一个数据帧中数据字段的最大长度。当一个IP数据报封装成数据链路层的帧的时候，数据报的总长度一定不能超过MTU。MTU与IP数据报首部中的总长度字段有关系，MTU是该字段的上限值。

## 4-18

**答：**（1）数据链路层只能接触到MAC帧，如果ARP在数据链路层，那么MAC帧中就需要有IP地址，这不符合数据链路层对MAC帧的结构定义。

（2）当网络中IP地址与硬件地址的映射发生变化时，ARP高速缓存中对应项就需要改变。超时时间设置太短会使ARP请求和响应分组的通信太频繁，若设置太长会使得硬件地址变化的主机迟迟无法与网络上其他主机通信。设置10~20分钟主要是因为在这样的一段时间段内更换网卡是很合理的。

（3）①源主机的ARP高速缓存中已经有了目的主机的MAC地址；②源主机发送的是广播分组；③源主机与目的主机间使用点对点链路。

## 4-24

**答：**A类子网划分对应数目的子网，子网掩码第一个字节需要全为1。若需要划分为n个A类子网，主机号部分的1的个数为$\lceil \log_2(n + 2) \rceil$（去除了全0和全1的子网数）。

（1）$n=2$，主机号部分1的数量为2，因此子网掩码为255.192.0.0；

（2）$n=6$，主机号部分1的数量为3，因此子网掩码为255.224.0.0；

（3）$n=30$，主机号部分1的数量为5，因此子网掩码为255.248.0.0；

（4）$n=62$，主机号部分1的数量为6，因此子网掩码为255.252.0.0；

（5）$n=122$，主机号部分1的数量为7，因此子网掩码为255.254.0.0（实际有126个子网）；

（6）$n=250$，主机号部分1的数量为8，因此子网掩码为255.255.0.0（实际有254个子网）；

## 4-25

**答：**（1）10110000.0.0.0，其中1不是连续的，不推荐使用；

（2）01100000.0.0.0，首位不是1（1前面有0），不推荐使用；

（3）01111111.11000000.0.0，首位不是1（1前面有0），不推荐使用；

（4）11111111.10000000.0.0，合理，推荐使用。

## 4-31

**答：**86.32/12的网络前缀为0101 0110 0010。

（1）86.33.224.123的前12位为0101 0110 0010，与上述网络前缀匹配。

（2）86.79.65.216的前12位为0101 0110 0100，与上述网络前缀不匹配。

（3）86.58.119.74的前12位为0101 0110 0011，与上述网络前缀不匹配。

（4）86.68.206.154的前12位为0101 0110 0100，与上述网络前缀不匹配。

## 4-35

**答：**转化为二进制为**10001100.01111000.0101**0100.00011000。

最大地址：**10001100.01111000.0101**1111.11111111，即140.120.95.255/20；

最小地址：**10001100.01111000.0101**0000.00000000，即140.120.80.0/20；

地址掩码：255.255.240.0；

地址块中共有$2^{12}=4096$个地址；

相当于$2^{24-20}=2^4=16$个C类地址。

## 4-38

**答：**IGP是内部网关协议，是在一个自治系统内部使用的路由选择协议；EGP是外部网关协议，是在不同的自治系统间使用的路由选择协议。

## 4-39

**答：**RIP协议是一种分布式的基于距离向量的路由选择协议，是互联网的标准协议，其最大优点就是简单，其主要特点为：

- 仅和相邻路由器交换信息；
- 路由器交换的信息是本路由器所知道的全部信息；
- 按固定的时间间隔交换路由信息。

OSPF使用分布式的链路状态协议，其主要特点为：

- 使用洪泛法向本自治系统中所有路由器发送信息；
- 发送的信息就是与本路由器相邻的所有路由器的链路状态，但这只是路由器所知道的部分信息；
- 当链路状态变化或每隔一段时间，路由器向所有路由器用洪泛法发送链路状态信息；
- 对于不同类型的业务可计算出不同的路由；
- 多路径间存在负载均衡；
- 所有在OSPF路由器之间交换的分组都具有鉴别功能；
- 支持可变长度的子网划分和无分类的编址CIDR；
- 每一个链路状态都会带上一个32位的序号，序号越大状态就越新。

BGP是不同自治系统的路由器之间交换路由信息的协议，它采用路径向量路由选择协议，其主要特点为：

- BGP在自治系统之问交换“可达性”信息；
- BGP只能是力求寻找一条能够到达目的网络且比较好的路由（不能兜圈子），而并非要寻找一条最佳路由；
- BGP的路由选择有很多策略，如选择本地偏好值最高的路由、选择AS跳数最少的路由、使用热土豆算法等；
- BGP有四种报文，在不同的场合使用不同的报文。

## 4-43

**答：**IGMP协议是让连接在本地局域网上的多播路由器知道本局域网上是否有主机（严格讲，是主机上的某个进
程）参加或退出了某个多播组。IGMP协议的要点主要体现在两个阶段：

- 当某个主机加入新的多播组时，该主机应向多播组的多播地址发送一个IGMP报文，声明自己要成为该组的成员。本地的多播路由器收到IGMP报文后，还要利用多播路由选择协议把这种组成员关系转发给互联网上的其他多播路由器。
- 本地多播路由器要周期性地探询本地局域网上的主机，以便知道这些主机是否还继续是组的成员。只要有一个主机对某个组响应，那么多播路由器就认为这个组是活跃的。但一个组在经过几次的探询后仍然没有一个主机响应，多播路由器就认为本网络上的主机已经都离开了这个组，因此也就不再把这个组的成员关系转发给其他
  的多播路由器。

当两个多播网络之间的网络不支持多播时，会使用隧道技术。在这种情况下，发送方网络路由器会对多播数据进行再次封装，加上普通数据报首部，使之变成单播数据报，这样就能通过中间网络（此时相当于构建了一个隧道）传输到另一个多播网络，目的网络路由器收到此数据报后先剥去其首部，变成原来的多播数据报后再进行传输。

## 4-48

**答：**146.102.29.0的二进制为10010010.01100110.00011101.00000000；

   146.102.32.255的二进制为10010010.01100110.00100000.11111111；

从146.102.29.0（含）到146.102.29.255（含）有$256$个地址。而146.102.29.255（不含）到146.102.32.255（含）有$3\times 256$个地址，因此总共有$4\times 256=1024$个地址。

## 4-65

**答：**（1）0000 : 0000 : 0000 : 0000 : 0000 : 0000 : 0000 : 0000

（2）0000 : 00AA : 0000 : 0000 : 0000 : 0000 : 0000 : 0000

（3）0000 : 1234 : 0000 : 0000 : 0000 : 0000 : 0000 : 0003

（4）0123 : 0000 : 0000 : 0000 : 0000 : 0000 : 0001 : 0002